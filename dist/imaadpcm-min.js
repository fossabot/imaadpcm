/*
 imaadpcm
 JavaScript IMA ADPCM codec.
 Copyright (c) 2018 Rafael da Silva Rocha.
 https://github.com/rochars/imaadpcm

 References:
 http://www.cs.columbia.edu/~hgs/audio/dvi/
 https://github.com/acida/pyima
 https://wiki.multimedia.cx/index.php/IMA_ADPCM
 byte-data
 Readable data to and from byte buffers.
 Copyright (c) 2017 Rafael da Silva Rocha.
 https://github.com/rochars/byte-data

 endianness
 Swap endianness in byte arrays.
 Copyright (c) 2017 Rafael da Silva Rocha.
 https://github.com/rochars/endianness

*/
var q="function"==typeof Object.create?Object.create:function(h){function a(){}a.prototype=h;return new a},u;if("function"==typeof Object.setPrototypeOf)u=Object.setPrototypeOf;else{var w;a:{var x={I:!0},y={};try{y.__proto__=x;w=y.I;break a}catch(h){}w=!1}u=w?function(h,a){h.__proto__=a;if(h.__proto__!==a)throw new TypeError(h+" is not extensible");return h}:null}var z=u;
function A(h,a){h.prototype=q(a.prototype);h.prototype.constructor=h;if(z)z(h,a);else for(var b in a)if("prototype"!=b)if(Object.defineProperties){var e=Object.getOwnPropertyDescriptor(a,b);e&&Object.defineProperty(h,b,e)}else h[b]=a[b];h.Ca=a.prototype}
for(var B="function"==typeof Object.defineProperties?Object.defineProperty:function(h,a,b){h!=Array.prototype&&h!=Object.prototype&&(h[a]=b.value)},C="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global&&null!=global?global:this,D=["Object","assign"],E=0;E<D.length-1;E++){var F=D[E];F in C||(C[F]={});C=C[F]}
var G=D[D.length-1],H=C[G],I=H?H:function(h,a){for(var b=1;b<arguments.length;b++){var e=arguments[b];if(e)for(var f in e)Object.prototype.hasOwnProperty.call(e,f)&&(h[f]=e[f])}return h};I!=H&&null!=I&&B(C,G,{configurable:!0,writable:!0,value:I});
(function(h){function a(e){if(b[e])return b[e].b;var f=b[e]={na:e,L:!1,b:{}};h[e].call(f.b,f,f.b,a);f.L=!0;return f.b}var b={};a.D=h;a.w=b;a.h=function(b,f){a.o(b)||Object.defineProperty(b,"a",{configurable:!1,enumerable:!0,get:f})};a.B=function(b){var f=b&&b.aa?function(){return b["default"]}:function(){return b};a.h(f,f);return f};a.o=function(a){return Object.prototype.hasOwnProperty.call(a,"a")};a.C="";return a(a.F=1)})([function(h,a,b){function e(a){var c=k.call(this,a)||this;c.char=a["char"];
c.s=a["float"];c.J();return c}var f=new Float32Array(1),d=new Int32Array(f.buffer),c=new Float64Array(1),g=new Uint32Array(c.buffer),k=b(4);A(e,k);e.prototype.N=function(a,c){a=this.i(a,c,{bits:16,offset:2});c=(a&31744)>>10;var b=a&1023;return(c?Math.pow(2,c-15)*(1+b/1024):b/1024*.00006103515625)*(a>>15?-1:1)};e.prototype.O=function(a,c){d[0]=this.i(a,c,{bits:32,offset:4});return f[0]};e.prototype.P=function(a,b){g[0]=this.i(a,b,{bits:32,offset:4});g[1]=this.i(a,b+4,{bits:32,offset:4});return c[0]};
e.prototype.S=function(a,c){for(var b="",d=0;d<this.offset;)b+=String.fromCharCode(a[c+d]),d++;return b};e.prototype.Y=function(a,b,d){c[0]=b;b={a:32,offset:4,u:255};d=this.m(a,g[0],d,b);return this.m(a,g[1],d,b)};e.prototype.X=function(a,c,b,g){f[0]=c;return b=this.m(a,d[0],b,g)};e.prototype.W=function(a,c,b){f[0]=c;var g=d[0];c=g>>16&32768;var k=g>>12&2047;g=g>>23&255;103<=g&&(c=(c|g-112<<10|k>>1)+(k&1));a[b++]=c&255;a[b++]=c>>>8&255;return b};e.prototype.Z=function(a,c,b){a[b++]=c.charCodeAt(0);
return b};e.prototype.J=function(){this.T();this.U();this.s&&(this.min=-Infinity,this.max=Infinity)};e.prototype.T=function(){this.s?16==this.a?this.g=this.N:32==this.a?this.g=this.O:64==this.a&&(this.g=this.P):this.char?this.g=this.S:32<this.a&&(this.g=this.R)};e.prototype.U=function(){this.s?16==this.a?this.j=this.W:32==this.a?this.j=this.X:64==this.a&&(this.j=this.Y):this.char&&(this.j=this.Z)};h.b=e},function(h,a,b){function e(a){a-=l;if(0<=a)var c=0;else c=8,a=-a;var b=t[p],d=b>>3;a>b&&(c|=4,
a-=b,d+=b);b>>=1;a>b&&(c|=2,a-=b,d+=b);b>>=1;a>b&&(c|=1,d+=b);l=c&8?l-d:l+d;-32768>l?l=-32768:32767<l&&(l=32767);p+=v[c&7];0>p?p=0:88<p&&(p=88);return c}function f(a){var c=a[0];e(c);var b=[];b.push(g.G(c,k)[0]);b.push(g.G(c,k)[1]);b.push(p);b.push(0);c=0;for(var d=1;d<a.length;d++)if(c++,1==c){var f=e(a[d]),h=e(a[d+1]);b.push(h<<4|f)}else c=0;for(;256>b.length;)b.push(0);return b}function d(a){var b=0;a&4&&(b+=r);a&2&&(b+=r>>1);a&1&&(b+=r>>2);b+=r>>3;a&8&&(b=-b);m+=b;32767<m?m=32767:-32767>m&&(m=
-32767);n+=v[a];0>n?n=0:88<n&&(n=88);r=t[n];return m}function c(a){m=g.V([a[0],a[1]],k);n=a[2];r=t[n];for(var b=[m],c=4;c<a.length;c++){var f=a[c],e=f>>4;b.push(d(e<<4^f));b.push(d(e))}return b}var g=b(2),k=g.K,v=[-1,-1,-1,-1,2,4,6,8,-1,-1,-1,-1,2,4,6,8],t=[7,8,9,10,11,12,13,14,16,17,19,21,23,25,28,31,34,37,41,45,50,55,60,66,73,80,88,97,107,118,130,143,157,173,190,209,230,253,279,307,337,371,408,449,494,544,598,658,724,796,876,963,1060,1166,1282,1411,1552,1707,1878,2066,2272,2499,2749,3024,3327,3660,
4026,4428,4871,5358,5894,6484,7132,7845,8630,9493,10442,11487,12635,13899,15289,16818,18500,20350,22385,24623,27086,29794,32767],l=0,p=0,m=0,n=0,r=7;h.b.encode=function(a){for(var b=[],c=[],d=0,g=0;g<a.length;g++)505>d?(c.push(a[g]),d++):(b=b.concat(f(c)),c=[],d=0);return b};h.b.decode=function(a,b){b=void 0===b?256:b;for(var d=[],g=[],k=0,f=0;f<a.length;f++)k<b-1?(g.push(a[f]),k++):(d=d.concat(c(g)),g=[],k=0);return d};h.b.ea=f;h.b.da=c},function(h,a,b){function e(a,b,c){var g=[];b.char?g=b.char?
a.slice(0,b.c/8):a:Array.isArray(a)||(g=[a]);return d.H(g,d.l(b,void 0===c?10:c))}function f(a,b,c){a=d.A(a.slice(0,8>b.a?b.a:b.c/8),d.l(b,void 0===c?10:c));return a=b.char?a.slice(0,b.a/8):a[0]}var d=b(3),c=b(0);a.G=e;a.V=f;a.Aa=function(a,b,c){return d.H(a,d.l(b,void 0===c?10:c))};a.Qa=function(a,b,c){return d.A(a,d.l(b,void 0===c?10:c))};a.Ra=function(a,b,c){c=void 0===c?10:c;for(var d=0,g=0;g<b.length;g++)d+=b[g].c/8;if(a.length<d)return[];d=[];for(var e=g=0;g<b.length;){var k=8>b[g].a?1:b[g].c/
8;d=d.concat(f(a.slice(e,e+k),b[g],c));e+=k;g++}return d};a.Ba=function(a,b,c){c=void 0===c?10:c;if(a.length<b.length)return[];for(var d=[],g=0;g<b.length;g++)d=d.concat(e(a[g],b[g],c));return d};a.fa=function(a,b){for(var d,g=0;g<a.length;g++)if(d=f(a.slice(g,g+b.length+1),new c({bits:8*b.length,"char":!0})),d==b)return g;return-1};a.$=c;a.ca=new c({bits:8,"char":!0});a.ma=new c({bits:32,"char":!0});a.ba=new c({bits:1});a.pa=new c({bits:2,signed:!0});a.Fa=new c({bits:2});a.ua=new c({bits:4,signed:!0});
a.Ka=new c({bits:4});a.za=new c({bits:8,signed:!0});a.Pa=new c({bits:8});a.K=new c({bits:16,signed:!0});a.Da=new c({bits:16});a.ga=new c({bits:16,"float":!0});a.qa=new c({bits:24,signed:!0});a.Ga=new c({bits:24});a.sa=new c({bits:32,signed:!0});a.Ia=new c({bits:32});a.ia=new c({bits:32,"float":!0});a.va=new c({bits:40,signed:!0});a.La=new c({bits:40});a.xa=new c({bits:48,signed:!0});a.Na=new c({bits:48});a.ka=new c({bits:64,"float":!0});a.oa=new c({bits:16,signed:!0,be:!0});a.Ea=new c({bits:16,be:!0});
a.ha=new c({bits:16,"float":!0,be:!0});a.ra=new c({bits:24,signed:!0,be:!0});a.Ha=new c({bits:24,be:!0});a.ta=new c({bits:32,signed:!0,be:!0});a.Ja=new c({bits:32,be:!0});a.ja=new c({bits:32,"float":!0,be:!0});a.wa=new c({bits:40,signed:!0,be:!0});a.Ma=new c({bits:40,be:!0});a.ya=new c({bits:48,signed:!0,be:!0});a.Oa=new c({bits:48,be:!0});a.la=new c({bits:64,"float":!0,be:!0})},function(h,a,b){var e=b(0),f=b(5);a.l=function(a,b){a=Object.assign(new e({}),a);a.f=b;return a};a.H=function(a,b){for(var c=
0,d=0,e=a.length,h=[];c<e;)d=b.j(h,a[c++],d);b.v&&f(h,b.offset);if(10!=b.f){a=b.f;c=0;for(d=h.length;c<d;)h[c]=h[c].toString(a),c++;a=0;c=h.length;for(b=(2==b.f?8:2)+1;a<c;)h[a]=Array(b-h[a].length).join("0")+h[a],a++}return h};a.A=function(a,b){b.v&&f(a,b.offset);if(10!=b.f)for(var c=b.f,d=0,e=a.length;d<e;)a[d]=parseInt(a[d],c),d++;c=[];d=0;for(e=a.length-(b.offset-1);d<e;)c.push(b.g(a,d)),d+=b.offset;b.char&&(c=c.join(""));return c}},function(h){function a(a){this.a=a.bits;this.v=a.be;this.D=a.signed;
this.f=a.base?a.base:10;this.g=this.i;this.j=this.m;this.offset=0;this.min=-Infinity;this.max=Infinity;this.c=this.a;this.u=255;this.o()}a.prototype.sign=function(a){a>this.max&&(a-=2*this.max+2);return a};a.prototype.h=function(a){a>this.max?a=this.max:a<this.min&&(a=this.min);return a};a.prototype.i=function(a,e,f){var b=0;for(f=(void 0===f?this:f).offset-1;0<f;)b|=a[f+e]<<8*f,f--;b=(a[e]|b)>>>0;return this.h(this.sign(b))};a.prototype.R=function(a,e,f){f=void 0===f?this:f;for(var b="",c=0;c<f.offset;){var g=
a[e+c].toString(2);b=Array(9-g.length).join("0")+g+b;c++}return this.h(this.sign(parseInt(b,2)))};a.prototype.m=function(a,e,f,d){d=void 0===d?this:d;e=this.h(e);var b=255,g=d.offset;f=this.M(a,e,f,d);for(var h=2;h<=g;h++)h==g&&(b=d.u),a[f++]=Math.floor(e/Math.pow(2,8*(h-1)))&b;return f};a.prototype.o=function(){this.F();this.C();this.w();this.B();this.offset=8>this.a?1:Math.ceil(this.c/8)};a.prototype.B=function(){var a=Math.pow(2,this.a);this.D?(this.max=a/2-1,this.min=-a/2):(this.max=a-1,this.min=
0)};a.prototype.F=function(){if(1>this.a||64<this.a)throw Error("Not a supported type.");};a.prototype.C=function(){this.c=8<this.a?16>=this.a?16:24>=this.a?24:32>=this.a?32:40>=this.a?40:48>=this.a?48:56>=this.a?56:64:this.a};a.prototype.w=function(){var a=8-(this.c-this.a);this.u=Math.pow(2,0<a?a:8)-1};a.prototype.M=function(a,e,f,d){d=void 0===d?this:d;8>d.a?a[f++]=0>e?e+Math.pow(2,d.a):e:a[f++]=e&255;return f};h.b=a},function(h){h.b=function(a,b){for(var e=a.length,f=0;f<e;){for(var d=a,c=f,g=
0,h=b-1,v=parseInt(b/2,10);g<v;){var t=d[c+g];d[c+g]=d[c+h];d[c+h]=t;g++;h--}f+=b}}}]);
